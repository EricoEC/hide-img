<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safebox - Base64 ç¼–è§£ç </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        body {
            background: #0f172a; /* æ·±è“åº• */
            min-height: 100vh;
            position: relative;
            overflow: hidden;
            color: #e0f2fe;
        }
        /* æå®¢ç½‘æ ¼èƒŒæ™¯ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(56, 189, 248, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(139, 92, 246, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -1;
            animation: gridScroll 15s linear infinite;
        }
        /* éœ“è™¹å…‰æ™•èƒŒæ™¯ */
        .glow-container {
            position: fixed;
            width: 600px;
            height: 600px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.2), transparent 70%);
            z-index: -1;
            filter: blur(80px);
            animation: glowPulse 8s ease-in-out infinite alternate;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        /* åŸå°ä¸åŠ¨ç§»æ¤çš„è¿”å›ä¸»é¡µæŒ‰é’®æ ·å¼ */
        .back-home {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 99999;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            border: 1px solid #ffc107;
            color: #fff;
            text-decoration: none;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            backdrop-filter: blur(4px);
        }
        .back-home:hover {
            background: rgba(0, 0, 0, 0.7);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 193, 7, 0.5);
        }
        /* åˆå§‹åˆ‡æ¢æŒ‰é’®ï¼ˆå±…ä¸­ï¼‰ */
        .mode-buttons {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            gap: 2rem;
            z-index: 100;
        }
        .mode-btn {
            padding: 1.5rem 3rem;
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid;
            border-image: linear-gradient(45deg, #38bdf8, #8b5cf6) 1;
            border-radius: 8px;
            color: #e0f2fe;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            backdrop-filter: blur(8px);
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.3);
        }
        .mode-btn:hover {
            transform: translateY(-8px);
            border-image: linear-gradient(45deg, #8b5cf6, #ec4899) 1;
            box-shadow: 0 0 25px rgba(139, 92, 246, 0.5);
            color: #f0abfc;
        }
        /* ç¼–è§£ç å®¹å™¨ï¼ˆåˆå§‹éšè—ï¼Œåˆ‡æ¢åå±•å¼€ï¼‰ */
        .code-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 2rem;
            padding-top: 80px; /* é¿å¼€è¿”å›æŒ‰é’® */
            display: none;
            flex-direction: column;
            gap: 1.5rem;
            z-index: 90;
            backdrop-filter: blur(4px);
            background: rgba(15, 23, 42, 0.6);
        }
        .code-container.active {
            display: flex;
            animation: fadeIn 0.5s ease;
        }
        /* æ ‡é¢˜æ ·å¼ */
        .code-title {
            font-size: 2rem;
            background: linear-gradient(90deg, #38bdf8, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-align: center;
            margin-bottom: 1rem;
        }
        /* ä¸Šä¼ /è¾“å…¥åŒºåŸŸ */
        .input-area {
            flex: 1;
            background: rgba(15, 23, 42, 0.8);
            border: 2px dashed rgba(56, 189, 248, 0.5);
            border-radius: 8px;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .input-area:hover {
            border-color: #8b5cf6;
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
        }
        .input-area input {
            display: none;
        }
        .input-icon {
            font-size: 4rem;
            color: #38bdf8;
            margin-bottom: 1rem;
        }
        .input-desc {
            font-size: 1.1rem;
            color: #94a3b8;
            text-align: center;
            max-width: 600px;
        }
        /* è§£ç è¾“å…¥æ¡† */
        .decode-input {
            flex: 1;
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid rgba(56, 189, 248, 0.5);
            border-radius: 8px;
            padding: 1.5rem;
            font-size: 1rem;
            color: #e0f2fe;
            resize: none;
            outline: none;
            transition: all 0.3s ease;
        }
        .decode-input:focus {
            border-color: #8b5cf6;
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
        }
        /* ç»“æœåŒºåŸŸ */
        .result-area {
            flex: 1;
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid rgba(56, 189, 248, 0.5);
            border-radius: 8px;
            padding: 1.5rem;
            overflow-y: auto;
            font-size: 0.9rem;
            color: #e0f2fe;
            white-space: pre-wrap;
            word-break: break-all;
        }
        /* æŒ‰é’®ç»„ */
        .btn-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        .action-btn {
            padding: 1rem 2rem;
            background: linear-gradient(45deg, #38bdf8, #8b5cf6);
            border: none;
            border-radius: 8px;
            color: #fff;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.3);
        }
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 25px rgba(139, 92, 246, 0.5);
            filter: brightness(1.1);
        }
        /* ä¸‹è½½é“¾æ¥ï¼ˆè§£ç æ–‡ä»¶ç”¨ï¼‰ */
        .download-link {
            display: none;
            text-align: center;
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(139, 92, 246, 0.2);
            border-radius: 8px;
            color: #f0abfc;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .download-link.active {
            display: block;
        }
        .download-link:hover {
            background: rgba(139, 92, 246, 0.4);
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.3);
        }
        /* æç¤ºæ¡† */
        .toast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translate(-50%, 100px);
            padding: 1rem 2rem;
            background: rgba(56, 189, 248, 0.9);
            border-radius: 8px;
            color: #0f172a;
            font-weight: 600;
            z-index: 9999;
            transition: all 0.3s ease;
            opacity: 0;
        }
        .toast.active {
            transform: translate(-50%, 0);
            opacity: 1;
        }
        /* åŠ¨ç”»å…³é”®å¸§ */
        @keyframes gridScroll {
            0% { background-position: 0 0; }
            100% { background-position: 30px 30px; }
        }
        @keyframes glowPulse {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 0.7; }
            100% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.9; }
        }
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .mode-buttons {
                flex-direction: column;
                gap: 1.5rem;
            }
            .mode-btn {
                padding: 1.2rem 2.5rem;
                font-size: 1.3rem;
            }
            .code-title {
                font-size: 1.6rem;
            }
            .input-icon {
                font-size: 3rem;
            }
            .input-desc {
                font-size: 1rem;
            }
            .btn-group {
                flex-direction: column;
            }
            .action-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- è¿”å›ä¸»é¡µæŒ‰é’® -->
    <a href="index.html" class="back-home" target="_self">â† ä¸»é¡µ</a>
    
    <div class="glow-container"></div>
    
    <!-- åˆå§‹æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
    <div class="mode-buttons">
        <button class="mode-btn" id="encodeBtn">Base64 ç¼–ç </button>
        <button class="mode-btn" id="decodeBtn">Base64 è§£ç </button>
    </div>
    
    <!-- ç¼–ç å®¹å™¨ -->
    <div class="code-container" id="encodeContainer">
        <h2 class="code-title">ğŸ“¤ æ–‡ä»¶ â†’ Base64 ç¼–ç </h2>
        <div class="input-area" id="fileUpload">
            <input type="file" id="fileInput" accept="*">
            <div class="input-icon">ğŸ“‚</div>
            <div class="input-desc">ç‚¹å‡»æˆ–æ‹–æ‹½ä»»æ„æ–‡ä»¶åˆ°æ­¤å¤„<br>æ”¯æŒå›¾ç‰‡ã€æ–‡æ¡£ã€å‹ç¼©åŒ…ç­‰æ‰€æœ‰æ ¼å¼æ ¼å¼</div>
        </div>
        <div class="result-area" id="encodeResult" placeholder="ç¼–ç ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></div>
        <div class="btn-group">
            <button class="action-btn" id="copyEncodeBtn">ä¸€é”®å¤åˆ¶ç¼–ç </button>
            <button class="action-btn" id="clearEncodeBtn">æ¸…ç©ºç»“æœ</button>
        </div>
    </div>
    
    <!-- è§£ç å®¹å™¨ -->
    <div class="code-container" id="decodeContainer">
        <h2 class="code-title">ğŸ“¥ Base64 â†’ æ–‡ä»¶/æ–‡æœ¬</h2>
        <textarea class="decode-input" id="decodeInput" placeholder="ç²˜è´´Base64ç¼–ç åˆ°æ­¤å¤„..."></textarea>
        <div class="btn-group">
            <button class="action-btn" id="decodeActionBtn">å¼€å§‹è§£ç </button>
            <button class="action-btn" id="clearDecodeBtn">æ¸…ç©ºè¾“å…¥</button>
        </div>
        <a href="#" class="download-link" id="downloadLink" download="decoded-file">ä¸‹è½½è§£ç æ–‡ä»¶</a>
        <div class="toast" id="toast"></div>
    </div>

    <script>
        // DOMå…ƒç´ 
        const modeButtons = document.querySelector('.mode-buttons');
        const encodeBtn = document.getElementById('encodeBtn');
        const decodeBtn = document.getElementById('decodeBtn');
        const encodeContainer = document.getElementById('encodeContainer');
        const decodeContainer = document.getElementById('decodeContainer');
        const fileUpload = document.getElementById('fileUpload');
        const fileInput = document.getElementById('fileInput');
        const encodeResult = document.getElementById('encodeResult');
        const copyEncodeBtn = document.getElementById('copyEncodeBtn');
        const clearEncodeBtn = document.getElementById('clearEncodeBtn');
        const decodeInput = document.getElementById('decodeInput');
        const decodeActionBtn = document.getElementById('decodeActionBtn');
        const clearDecodeBtn = document.getElementById('clearDecodeBtn');
        const downloadLink = document.getElementById('downloadLink');
        const toast = document.getElementById('toast');

        // æ¨¡å¼åˆ‡æ¢é€»è¾‘
        encodeBtn.addEventListener('click', () => {
            modeButtons.style.display = 'none';
            encodeContainer.classList.add('active');
            decodeContainer.classList.remove('active');
        });

        decodeBtn.addEventListener('click', () => {
            modeButtons.style.display = 'none';
            decodeContainer.classList.add('active');
            encodeContainer.classList.remove('active');
        });

        // ç¼–ç é€»è¾‘ï¼šæ–‡ä»¶è½¬Base64
        fileUpload.addEventListener('click', () => fileInput.click());
        fileUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUpload.style.borderColor = '#8b5cf6';
            fileUpload.style.boxShadow = '0 0 25px rgba(139, 92, 246, 0.5)';
        });
        fileUpload.addEventListener('dragleave', () => {
            fileUpload.style.borderColor = 'rgba(56, 189, 248, 0.5)';
            fileUpload.style.boxShadow = '0 0 20px rgba(139, 92, 246, 0.3)';
        });
        fileUpload.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUpload.style.borderColor = 'rgba(56, 189, 248, 0.5)';
            if (e.dataTransfer.files.length > 0) {
                handleFile(e.dataTransfer.files[0]);
            }
        });
        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                handleFile(fileInput.files[0]);
            }
        });

        // å¤„ç†æ–‡ä»¶ç¼–ç 
        function handleFile(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const base64 = e.target.result;
                encodeResult.textContent = base64;
                showToast(`ç¼–ç æˆåŠŸï¼æ–‡ä»¶å¤§å°ï¼š${(file.size / 1024).toFixed(2)}KB`);
            };
            reader.onerror = () => {
                showToast('æ–‡ä»¶è¯»å–å¤±è´¥ï¼Œè¯·é‡è¯•ï¼', 'error');
            };
            reader.readAsDataURL(file);
        }

        // å¤åˆ¶ç¼–ç 
        copyEncodeBtn.addEventListener('click', () => {
            if (!encodeResult.textContent) {
                showToast('æš‚æ— ç¼–ç ç»“æœå¯å¤åˆ¶ï¼', 'error');
                return;
            }
            navigator.clipboard.writeText(encodeResult.textContent).then(() => {
                showToast('ç¼–ç å·²æˆåŠŸå¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }).catch(() => {
                showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ï¼', 'error');
            });
        });

        // æ¸…ç©ºç¼–ç ç»“æœ
        clearEncodeBtn.addEventListener('click', () => {
            encodeResult.textContent = '';
            fileInput.value = '';
            showToast('ç»“æœå·²æ¸…ç©ºï¼');
        });

        // è§£ç é€»è¾‘ï¼šBase64è½¬æ–‡ä»¶
        decodeActionBtn.addEventListener('click', () => {
            const base64 = decodeInput.value.trim();
            if (!base64) {
                showToast('è¯·ç²˜è´´Base64ç¼–ç åå†è§£ç ï¼', 'error');
                return;
            }

            try {
                // åˆ†ç¦»Base64å¤´éƒ¨å’Œæ•°æ®
                const [header, data] = base64.split(',');
                let mimeType = 'application/octet-stream';
                if (header) {
                    mimeType = header.match(/:(.*?);/)[1];
                }

                // è§£ç Base64æ•°æ®
                const byteCharacters = atob(data || base64);
                const byteNumbers = new Array(byteCharacters.length);
                for (let i = 0; i < byteCharacters.length; i++) {
                    byteNumbers[i] = byteCharacters.charCodeAt(i);
                }
                const byteArray = new Uint8Array(byteNumbers);
                const blob = new Blob([byteArray], { type: mimeType });
                const url = URL.createObjectURL(blob);

                // è®¾ç½®ä¸‹è½½é“¾æ¥
                downloadLink.href = url;
                // è‡ªåŠ¨æå–æ–‡ä»¶åï¼ˆå¦‚æœæœ‰ï¼‰æˆ–ä½¿ç”¨é»˜è®¤å
                const fileNameMatch = base64.match(/filename=(.*?);/);
                if (fileNameMatch && fileNameMatch[1]) {
                    downloadLink.download = fileNameMatch[1];
                } else {
                    // æ ¹æ®MIMEç±»å‹è®¾ç½®é»˜è®¤æ‰©å±•å
                    const ext = mimeType.split('/')[1] || 'bin';
                    downloadLink.download = `decoded-file.${ext}`;
                }
                downloadLink.classList.add('active');
                showToast('è§£ç æˆåŠŸï¼ç‚¹å‡»ä¸‹è½½æ–‡ä»¶');
            } catch (error) {
                showToast('è§£ç å¤±è´¥ï¼è¯·è¾“å…¥æœ‰æ•ˆçš„Base64ç¼–ç ', 'error');
                downloadLink.classList.remove('active');
            }
        });

        // æ¸…ç©ºè§£ç è¾“å…¥
        clearDecodeBtn.addEventListener('click', () => {
            decodeInput.value = '';
            downloadLink.classList.remove('active');
            showToast('è¾“å…¥å·²æ¸…ç©ºï¼');
        });

        // æç¤ºæ¡†å‡½æ•°
        function showToast(message, type = 'success') {
            toast.textContent = message;
            toast.classList.add('active');
            if (type === 'error') {
                toast.style.background = 'rgba(236, 72, 153, 0.9)';
                toast.style.color = '#fff';
            } else {
                toast.style.background = 'rgba(56, 189, 248, 0.9)';
                toast.style.color = '#0f172a';
            }
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        // é¡µé¢åˆ·æ–°æ—¶é‡ç½®çŠ¶æ€
        window.addEventListener('load', () => {
            modeButtons.style.display = 'flex';
            encodeContainer.classList.remove('active');
            decodeContainer.classList.remove('active');
            encodeResult.textContent = '';
            decodeInput.value = '';
            downloadLink.classList.remove('active');
        });
    </script>
</body>
</html>
